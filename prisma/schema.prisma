// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  company      String?
  createdAt    DateTime @default(now())
  assessments  Assessment[]
}

model Assessment {
  id             String   @id @default(cuid())
  userId         String
  user           User     @relation(fields: [userId], references: [id])
  industry       String?
  companySize    String?
  // raw response payloads per module for transparency and re-scoring
  responses      Json
  // normalized sub-scores 0-100 by dimension (null if module not applicable)
  scoreInbound   Int?
  scoreOutbound  Int?
  scoreContent   Int?
  scorePaid      Int?
  scoreNurture   Int?
  scoreInfra     Int? // stack, data, integrations
  scoreAttribution Int?
  scoreOverall   Int      @default(0)
  growthLevers   Json     // array of recommended levers with confidence
  riskFlags      Json     // integration gaps, compliance, deliverability
  benchmarkPct   Int?     // percentile vs peers (later when you have data)
  pdfUrl         String?  // populated after PDF generation
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Benchmark {
  id           String   @id @default(cuid())
  industry     String
  dim          String   // inbound|outbound|content|paid|nurture|infra|attr
  p25          Int
  p50          Int
  p75          Int
  updatedAt    DateTime @updatedAt

  @@unique([industry, dim], name: "industry_dim")
}